From: Mike Hommey <mh+mozilla@glandium.org>
Date: Thu, 14 Jul 2011 13:54:49 +0200
Subject: Bug 671533 - Fix test_DownloadUtils.js with locales with a different
 decimal separator

---
 .../downloads/tests/unit/test_DownloadUtils.js     |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/toolkit/mozapps/downloads/tests/unit/test_DownloadUtils.js b/toolkit/mozapps/downloads/tests/unit/test_DownloadUtils.js
index 13cc57e..eb0f23d 100644
--- a/toolkit/mozapps/downloads/tests/unit/test_DownloadUtils.js
+++ b/toolkit/mozapps/downloads/tests/unit/test_DownloadUtils.js
@@ -39,7 +39,7 @@ Cu.import("resource://gre/modules/DownloadUtils.jsm");
 
 const gDecimalSymbol = Number(5.4).toLocaleString().match(/\D/);
 function _(str) {
-  return str.replace(".", gDecimalSymbol);
+  return str.replace(".", gDecimalSymbol, "g");
 }
 
 function testConvertByteUnits(aBytes, aValue, aUnit)
@@ -76,7 +76,7 @@ function testStatus(aCurr, aMore, aRate, aTest)
   }
 
   // Make sure the status text matches
-  do_check_eq(status, aTest[0].replace(/--/, gDash));
+  do_check_eq(status, _(aTest[0].replace(/--/, gDash)));
 
   // Make sure the lastSeconds matches
   if (last == Infinity)
