From: Steve Singer <steve@ssinger.info>
Date: Sun, 11 May 2014 12:09:51 +0900
Subject: Bug 961488 - Pass JSVAL as a pointer to the structure

---
 xpcom/reflect/xptcall/src/md/unix/xptcinvoke_ppc_linux.cpp | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_ppc_linux.cpp b/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_ppc_linux.cpp
index 7f235b4..5fa63a4 100644
--- a/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_ppc_linux.cpp
+++ b/xpcom/reflect/xptcall/src/md/unix/xptcinvoke_ppc_linux.cpp
@@ -45,8 +45,12 @@ invoke_copy_to_stack(uint32_t* d,
     uint64_t tempu64;
     
     for(uint32_t i = 0; i < paramCount; i++, s++) {
-        if(s->IsPtrData())
-            tempu32 = (uint32_t) s->ptr;
+        if(s->IsPtrData()) {
+            if(s->type == nsXPTType::T_JSVAL)
+                tempu32 = &s->ptr;
+            else    
+                tempu32 = (uint32_t) s->ptr;
+        }
         else {
             switch(s->type) {
             case nsXPTType::T_FLOAT:                                  break;
