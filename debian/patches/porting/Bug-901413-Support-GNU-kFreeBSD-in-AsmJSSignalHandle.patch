From: Mike Hommey <mh+mozilla@glandium.org>
Date: Mon, 5 Aug 2013 17:03:08 +0900
Subject: Bug 901413 - Support GNU/kFreeBSD in AsmJSSignalHandlers.cpp

---
 js/src/ion/AsmJSSignalHandlers.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/js/src/ion/AsmJSSignalHandlers.cpp b/js/src/ion/AsmJSSignalHandlers.cpp
index 560c16d..a4f60ff 100644
--- a/js/src/ion/AsmJSSignalHandlers.cpp
+++ b/js/src/ion/AsmJSSignalHandlers.cpp
@@ -103,7 +103,7 @@ using namespace mozilla;
 # define R13_sig(p) ((p)->uc_mcontext.__gregs[_REG_R13])
 # define R14_sig(p) ((p)->uc_mcontext.__gregs[_REG_R14])
 # define R15_sig(p) ((p)->uc_mcontext.__gregs[_REG_R15])
-#elif defined(__DragonFly__) || defined(__FreeBSD__)
+#elif defined(__DragonFly__) || defined(__FreeBSD__) || defined(__FreeBSD_kernel__)
 # if defined(__DragonFly__)
 #  define XMM_sig(p,i) (((union savefpu *)(p)->uc_mcontext.mc_fpregs)->sv_xmm.sv_xmm[i])
 # else
@@ -264,14 +264,14 @@ LookupHeapAccess(const AsmJSModule &module, uint8_t *pc)
 #  include <sys/mman.h>
 # endif
 
-# if defined(__FreeBSD__)
+# if defined(__FreeBSD__) || defined(__FreeBSD_kernel__)
 #  include <sys/ucontext.h> // for ucontext_t, mcontext_t
 # endif
 
 # if defined(JS_CPU_X64)
 #  if defined(__DragonFly__)
 #   include <machine/npx.h> // for union savefpu
-#  elif defined(__FreeBSD__) || defined(__OpenBSD__)
+#  elif defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__FreeBSD_kernel__)
 #   include <machine/fpu.h> // for struct savefpu/fxsave64
 #  endif
 # endif
