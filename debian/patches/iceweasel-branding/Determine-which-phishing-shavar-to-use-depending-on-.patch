From: Mike Hommey <mh@glandium.org>
Date: Thu, 1 Apr 2010 15:34:59 +0200
Subject: Determine which phishing shavar to use depending on
 MOZ_OFFICIAL_BRANDING

---
 browser/app/Makefile.in                            |    4 ++++
 browser/app/profile/firefox.js                     |    4 ++++
 toolkit/components/url-classifier/SafeBrowsing.jsm |    4 ++++
 3 files changed, 12 insertions(+)

diff --git a/browser/app/Makefile.in b/browser/app/Makefile.in
index 8cd5d19..98a0fef 100644
--- a/browser/app/Makefile.in
+++ b/browser/app/Makefile.in
@@ -138,6 +138,10 @@ libs::
 	$(INSTALL) $(IFLAGS1) $(DIST)/branding/default48.png  $(FINAL_TARGET)/chrome/icons/default
 endif
 
+ifdef MOZ_OFFICIAL_BRANDING
+DEFINES += -DMOZ_OFFICIAL_BRANDING
+endif
+
 libs:: $(srcdir)/profile/prefs.js
 	$(INSTALL) $(IFLAGS1) $^ $(FINAL_TARGET)/defaults/profile
 
diff --git a/browser/app/profile/firefox.js b/browser/app/profile/firefox.js
index b207cb9..b669070 100644
--- a/browser/app/profile/firefox.js
+++ b/browser/app/profile/firefox.js
@@ -737,7 +737,11 @@ pref("urlclassifier.gethashnoise", 4);
 pref("urlclassifier.randomizeclient", false);
 
 // The list of tables that use the gethash request to confirm partial results.
+#ifdef MOZ_OFFICIAL_BRANDING
 pref("urlclassifier.gethashtables", "goog-phish-shavar,goog-malware-shavar");
+#else
+pref("urlclassifier.gethashtables", "googpub-phish-shavar,goog-malware-shavar");
+#endif
 
 // If an urlclassifier table has not been updated in this number of seconds,
 // a gethash request will be forced to check that the result is still in
diff --git a/toolkit/components/url-classifier/SafeBrowsing.jsm b/toolkit/components/url-classifier/SafeBrowsing.jsm
index 675eb7b..4e3146f 100644
--- a/toolkit/components/url-classifier/SafeBrowsing.jsm
+++ b/toolkit/components/url-classifier/SafeBrowsing.jsm
@@ -10,7 +10,11 @@ const Cu = Components.utils;
 
 Cu.import("resource://gre/modules/Services.jsm");
 
+#ifdef MOZ_OFFICIAL_BRANDING
 const phishingList = "goog-phish-shavar";
+#else
+const phishingList = "googpub-phish-shavar";
+#endif
 const malwareList  = "goog-malware-shavar";
 
 var debug = false;
