// Disable Location-Aware Browsing
// http://www.mozilla.org/en-US/firefox/geolocation/
lockPref("geo.enabled",             false);
lockPref("browser.search.geoip.url",            "");

lockPref("media.peerconnection.enabled",            false);

// https://developer.mozilla.org/en-US/docs/Web/API/BatteryManager
lockPref("dom.battery.enabled",             false);

// https://wiki.mozilla.org/WebAPI/Security/WebTelephony
lockPref("dom.telephony.enabled",           false);

// https://developer.mozilla.org/en-US/docs/Web/API/navigator.sendBeacon
lockPref("beacon.enabled",          false);

// https://developer.mozilla.org/en-US/docs/Mozilla/lockPreferences/lockPreference_reference/dom.event.clipboardevents.enabled
lockPref("dom.event.clipboardevents.enabled",               false);

// https://wiki.mozilla.org/HTML5_Speech_API
lockPref("media.webspeech.recognition.enable",              false);

// Disable getUserMedia screen sharing
// https://mozilla.github.io/webrtc-landing/gum_test.html
lockPref("media.getusermedia.screensharing.enabled",                false);

// Disable sensor API
// https://wiki.mozilla.org/Sensor_API
lockPref("device.sensors.enabled",          false);

// Disable browser pings
// http://kb.mozillazine.org/Browser.send_pings
lockPref("browser.send_pings",              false);

// Disable health reporting
// https://support.mozilla.org/en-US/kb/firefox-health-report-understand-your-browser-perf
lockPref("datareporting.healthreport.uploadEnabled",                false);

// Disable collection of the data (the healthreport.sqlite* files)
lockPref("datareporting.healthreport.service.enabled",              false);

// https://gecko.readthedocs.org/en/latest/toolkit/components/telemetry/telemetry/preferences.html
lockPref("datareporting.policy.dataSubmissionEnabled",              false);

// Disable heartbeat
// https://wiki.mozilla.org/Advocacy/heartbeat
lockPref("browser.selfsupport.url",         "");

// Disable web notifications
lockPref("dom.webnotifications.enabled",            false);

// Display an error message indicating the entered information is not a valid URL
// http://kb.mozillazine.org/Keyword.enabled#Caveats
lockPref("keyword.enabled",         false);

// Don't try to guess URLs
// http://www-archive.mozilla.org/docs/end-user/domain-guessing.html
lockPref("browser.fixup.alternate.enabled",         false);

// Never try to use flash
lockPref("plugin.state.flash",              0);

// http://forums.mozillazine.org/viewtopic.php?p=13845077&sid=28af2622e8bd8497b9113851676846b1#p13845077
lockPref("media.gmp-provider.enabled",            false);
// https://support.mozilla.org/en-US/kb/how-stop-firefox-making-automatic-connections#w_media-capabilities
lockPref("media.gmp-gmpopenh264.enabled",               false);
lockPref("media.gmp-manager.url",               "");

// https://blog.mozilla.org/addons/how-to-turn-off-add-on-updates/
pref("extensions.update.enabled",               true);

// https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-2743
lockPref("pdfjs.disabled",          true);

// Disable 3DES
lockPref("security.ssl3.dhe_dss_des_ede3_sha",              false);
lockPref("security.ssl3.dhe_rsa_des_ede3_sha",              false);
lockPref("security.ssl3.ecdh_ecdsa_des_ede3_sha",           false);
lockPref("security.ssl3.ecdh_rsa_des_ede3_sha",             false);
lockPref("security.ssl3.ecdhe_ecdsa_des_ede3_sha",          false);
lockPref("security.ssl3.ecdhe_rsa_des_ede3_sha",            false);
lockPref("security.ssl3.rsa_des_ede3_sha",          false);
lockPref("security.ssl3.rsa_fips_des_ede3_sha",             false);

// Prevent logjamming.
lockPref("security.ssl3.dhe_rsa_camellia_256_sha",          false);
lockPref("security.ssl3.dhe_rsa_aes_256_sha",               false);

// Disable DSA.
lockPref("security.ssl3.dhe_dss_aes_128_sha",               false);
lockPref("security.ssl3.dhe_dss_aes_256_sha",               false);
lockPref("security.ssl3.dhe_dss_camellia_128_sha",          false);
lockPref("security.ssl3.dhe_dss_camellia_256_sha",          false);

// Disable null ciphers.
lockPref("security.ssl3.rsa_null_sha",              false);
lockPref("security.ssl3.rsa_null_md5",              false);
lockPref("security.ssl3.ecdhe_rsa_null_sha",                false);
lockPref("security.ssl3.ecdhe_ecdsa_null_sha",              false);
lockPref("security.ssl3.ecdh_rsa_null_sha",         false);
lockPref("security.ssl3.ecdh_ecdsa_null_sha",               false);

// Disable RC4.
lockPref("security.ssl3.ecdh_ecdsa_rc4_128_sha",            false);
lockPref("security.ssl3.ecdh_rsa_rc4_128_sha",              false);
lockPref("security.ssl3.ecdhe_ecdsa_rc4_128_sha",           false);
lockPref("security.ssl3.ecdhe_rsa_rc4_128_sha",             false);
lockPref("security.ssl3.rsa_rc4_128_md5",           false);
lockPref("security.ssl3.rsa_rc4_128_sha",           false);
lockPref("security.tls.unrestricted_rc4_fallback",          false);

// Disable RC4.
lockPref("security.ssl3.ecdh_ecdsa_rc4_128_sha",            false);
lockPref("security.ssl3.ecdh_rsa_rc4_128_sha",              false);
lockPref("security.ssl3.ecdhe_ecdsa_rc4_128_sha",           false);
lockPref("security.ssl3.ecL:qdhe_rsa_rc4_128_sha",             false);
lockPref("security.ssl3.rsa_rc4_128_md5",           false);
lockPref("security.ssl3.rsa_rc4_128_sha",           false);
lockPref("security.tls.unrestricted_rc4_fallback",          false);

// Disable 40 bit
lockPref("security.ssl3.rsa_rc4_40_md5",            false);
lockPref("security.ssl3.rsa_rc2_40_md5",            false);


// Disable 56 bit
lockPref("security.ssl3.rsa_1024_rc4_56_sha",               false);

// Disable 128 bit
lockPref("security.ssl3.rsa_camellia_128_sha",              false);
lockPref("security.ssl3.ecdhe_rsa_aes_128_sha",             false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_128_sha",           false);
lockPref("security.ssl3.ecdh_rsa_aes_128_sha",              false);
lockPref("security.ssl3.ecdh_ecdsa_aes_128_sha",            false);
lockPref("security.ssl3.dhe_rsa_camellia_128_sha",          false);
lockPref("security.ssl3.dhe_rsa_aes_128_sha",               false);

// But enable ECDHE with more than 128 bits
lockPref("security.ssl3.ecdhe_rsa_aes_256_sha",         true);
lockPref("security.ssl3.ecdhe_ecdsa_aes_256_sha",               true);

// Fallbacks for compatibility
lockPref("security.ssl3.rsa_aes_256_sha",               true);
lockPref("security.ssl3.rsa_aes_128_sha",               true);

// disable SSLv3
lockPref("security.enable_ssl3",                false);
lockPref("security.ssl3.ecdh_rsa_aes_256_sha",          false);
lockPref("security.ssl3.ecdh_ecdsa_aes_256_sha",                false);
lockPref("security.ssl3.rsa_camellia_256_sha",          false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_128_gcm_sha256",                true);
lockPref("security.ssl3.ecdhe_rsa_aes_128_gcm_sha256",          true);

lockPref("security.tls.version.min",            1);
lockPref("security.tls.version.max",            3);


// https://wiki.mozilla.org/SecurityEngineering/Public_Key_Pinning#How_to_use_pinning
lockPref("security.cert_pinning.enforcement_level",             2);

// https://blog.mozilla.org/security/2012/10/11/click-to-play-plugins-blocklist-style/
lockPref("plugins.click_to_play",               true);

lockPref("browser.newtabpage.enhanced",         false);
lockPref("browser.newtab.preload",              false);
lockPref("browser.newtabpage.directory.ping",           "");
lockPref("browser.newtabpage.directory.source",         "data:text/plain,{}");

// https://support.mozilla.org/en-US/kb/save-web-pages-later-pocket-firefox
lockPref("browser.pocket.enabled",              false);

// https://wiki.mozilla.org/Loop
lockPref("loop.enabled",              false);

// https://www.mozilla.org/en-US/firefox/39.0/releasenotes/
// https://wiki.mozilla.org/Security/Application_Reputation
lockPref("browser.safebrowsing.downloads.remote.enabled",       false);


// https://support.mozilla.org/en-US/kb/how-stop-firefox-making-automatic-connections#w_auto-update-checking
lockPref("browser.search.update",               false);
// https://support.mozilla.org/en-US/kb/how-stop-firefox-making-automatic-connections#w_mozilla-content
lockPref("browser.aboutHomeSnippets.updateUrl",         "");
// https://support.mozilla.org/en-US/kb/how-stop-firefox-making-automatic-connections#w_speculative-pre-connections
lockPref("network.http.speculative-parallel-limit",             0);
// http://kb.mozillazine.org/Browser.search.suggest.enabled
lockPref("browser.search.suggest.enabled",              false);

lockPref("network.prefetch-next",           false);
lockPref("network.dns.disableprefetch",             true);
lockPref("network.dns.disableprefetchFromHTTPS",            true);
// https://wiki.mozilla.org/Privacy/Reviews/Necko
lockPref("network.predictor.enabled",           false);


// https://bugzilla.mozilla.org/show_bug.cgi?id=855326
lockPref("security.csp.experimentalEnabled",            true);
// CSP https://developer.mozilla.org/en-US/docs/Web/Security/CSP/Introducing_Content_Security_Policy
lockPref("security.csp.enable",         true);

lockPref("privacy.clearOnShutdown.downloads",           true);
lockPref("browser.download.manager.retention",          0);

lockPref("signon.rememberSignons",              false);
lockPref("security.ask_for_password",           0);

// https://wiki.mozilla.org/Privacy/Reviews/New_Tab
lockPref("browser.newtabpage.enabled",          false);
// https://support.mozilla.org/en-US/kb/new-tab-page-show-hide-and-customize-top-sites#w_how-do-i-turn-the-new-tab-page-off
lockPref("browser.newtab.url",          "about:blank");

// http://dbaron.org/mozilla/visited-privacy
lockPref("layout.css.visited_links_enabled",            false);

cat << EOF >>debian/vendor.js.in
lockPref("browser.urlbar.maxRichResults",               0);


// https://wiki.mozilla.org/SVGOpenTypeFonts
// the iSEC Partners Report recommends to disable this
lockPref("gfx.font_rendering.opentype_svg.enabled",         false);


// DDG as default search engine
defaultlockPref("browser.search.defaultenginename",              "DuckDuckGo");

// Disable Mozilla extension signing check.
defaultlockPref("xpinstall.signatures.required",	"false");





