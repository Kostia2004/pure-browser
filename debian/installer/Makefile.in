DEPTH		= ../..
topsrcdir	= @top_srcdir@
srcdir		= @srcdir@
VPATH		= @srcdir@

include $(DEPTH)/config/autoconf.mk

include $(topsrcdir)/config/rules.mk

DEFINES += -DAB_CD=$(MOZ_UI_LOCALE) -DMOZ_APP_NAME=$(MOZ_APP_NAME) -DPREF_DIR=$(PREF_DIR)
DEFINES += -DMOZ_ENABLE_GNOME_COMPONENT=1
DEFINES += -DMOZ_GTK2=1
DEFINES += -DMOZ_UPDATER=1
DEFINES += -DBINPATH=bin
DEFINES += -DDLL_PREFIX=$(DLL_PREFIX) -DDLL_SUFFIX=$(DLL_SUFFIX) -DBIN_SUFFIX=$(BIN_SUFFIX)
ifeq (,$(filter 1.9.%,$(GRE_VERSION)))
DEFINES += -DWITH_MANIFEST=1
endif

ifdef MOZ_IPC
include $(topsrcdir)/ipc/app/defs.mk
DEFINES += -DMOZ_CHILD_PROCESS_NAME=$(MOZ_CHILD_PROCESS_NAME)
endif

package-manifest: $(topsrcdir)/browser/installer/package-manifest.in $(srcdir)/package-manifest.$(MOZ_BUILD_APP)
	$(PYTHON) $(topsrcdir)/config/Preprocessor.py $(DEFINES) $(ACDEFINES) $^ | sed 's/^\[browser\]/[$(MOZ_BUILD_APP)]/' > $@

GARBAGE += package-manifest

libs:: package-manifest
